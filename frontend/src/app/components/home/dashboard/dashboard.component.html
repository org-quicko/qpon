<div class="p-6 space-y-8">

  <!-- ðŸ§¾ Sales Analytics -->
  <ng-container *ngIf="salesLoading(); else salesAnalyticsContent">
    <!-- Skeleton for Sales Summary header + cards -->
    <div class="space-y-2">
      <ngx-skeleton-loader count="1" [theme]="{ width: '300px', height: '24px', borderRadius: '6px' }"></ngx-skeleton-loader>
      <ngx-skeleton-loader count="1" [theme]="{ width: '200px', height: '18px', borderRadius: '6px' }"></ngx-skeleton-loader>
    </div>

    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4 mt-4">
      <ngx-skeleton-loader *ngFor="let i of [1,2,3,4]"
        [theme]="{
          height: '110px',
          borderRadius: '10px',
          background: 'var(--skeleton-bg)'
        }">
      </ngx-skeleton-loader>
    </div>
  </ng-container>

  <ng-template #salesAnalyticsContent>
    <app-dashboard-sales-analytics [userName]="user()?.name | titlecase" [stats]="stats()">
    </app-dashboard-sales-analytics>
  </ng-template>

  <!-- ðŸ›’ Item Popularity -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-6">

    <!-- Left: Product popularity -->
    <ng-container *ngIf="itemLoading(); else itemPopularityContent">
      <div class="flex flex-col space-y-3">
        <ngx-skeleton-loader [theme]="{ width: '60%', height: '18px', borderRadius: '4px' }"></ngx-skeleton-loader>
        <ngx-skeleton-loader *ngFor="let i of [1,2,3,4,5]"
          [theme]="{ width: '100%', height: '36px', borderRadius: '8px' }">
        </ngx-skeleton-loader>
      </div>
    </ng-container>
    <ng-template #itemPopularityContent>
      <app-popularity-chart
        [title]="'Most popular products'"
        [labelColumn]="'Products'"
        [valueColumn]="'Redemptions'"
        [data]="itemPopularityData()">
      </app-popularity-chart>
    </ng-template>

    <!-- Right: Coupon popularity -->
    <ng-container *ngIf="couponLoading(); else couponPopularityContent">
      <div class="flex flex-col space-y-3">
        <ngx-skeleton-loader [theme]="{ width: '60%', height: '18px', borderRadius: '4px' }"></ngx-skeleton-loader>
        <ngx-skeleton-loader *ngFor="let i of [1,2,3,4,5]"
          [theme]="{ width: '100%', height: '36px', borderRadius: '8px' }">
        </ngx-skeleton-loader>
      </div>
    </ng-container>
    <ng-template #couponPopularityContent>
      <app-popularity-chart
        [title]="'Most popular coupon codes'"
        [labelColumn]="'Codes'"
        [valueColumn]="'Redemptions'"
        [data]="couponPopularityData()">
      </app-popularity-chart>
    </ng-template>

  </div>

  <!-- ðŸ“ˆ Sales Trend Chart -->
  <div class="mt-6 h-[300px] mb-8">
    <ng-container *ngIf="salesLoading(); else salesChartContent">
      <ngx-skeleton-loader count="1" [theme]="{ height: '320px', borderRadius: '10px', background: 'var(--skeleton-bg)' }"></ngx-skeleton-loader>
    </ng-container>

    <ng-template #salesChartContent>
      <app-sales-trend-chart
        [graphData]="graphData()"
        [dateRangeType]="dateRangeStore.activeRange()"
        [startDate]="dateRangeStore.start()"
        [endDate]="dateRangeStore.end()">
      </app-sales-trend-chart>
    </ng-template>
  </div>

  <!-- ðŸ’³ Redemption List -->
  <div class="mt-6 mb-8">
    <app-recent-redemption-list></app-recent-redemption-list>
  </div>
</div>
